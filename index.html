<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calendrier des Sardanes-test</title>
              <!-- feuille de style -->
              <style>
                body {
                  background-color: #ffe6f2;
                }
                            
                 #liste-sardanes {
                  list-style: none;
                  padding: 0;
                }
                .event-card {
                  background: #f7f7f7;
                  border-radius: 8px;
                  padding: 12px 16px;
                  margin-bottom: 12px;
                  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                  font-family: sans-serif;
                }
                .event-date {
                  font-size: 1.1em;
                  font-weight: bold;
                  margin-bottom: 4px;
                }
                .event-lieu {
                  margin-bottom: 4px;
                }
                .event-salle {
                  font-size: 1.1em;
                  font-weight: bold;
                  margin-bottom: 4px;
                }
                .event-type {
                  display: inline-block;
                  background: #e0e0e0;
                  padding: 2px 8px;
                  border-radius: 6px;
                  font-size: 0.85em;
                  margin-top: 6px;
                }
                            .grid { 
                              display: grid; 
                              grid-template-columns: repeat(3, 1fr); 
                              gap: 15px; 
                              padding: 10px; 
                            } 
                /* Tablettes et écrans moyens → 2 colonnes */
                @media (max-width: 900px) {
                  .grid { 
                    grid-template-columns: repeat(2, 1fr);
                  } 
                } 
                /* Téléphones → 1 colonne */ 
                @media (max-width: 600px) { 
                  .grid { grid-template-columns: 1fr;
                        }
                }
              </style>
</head>
<body>

  <h1 style="text-align:center;">Bienvenue sur le Calendrier des Sardanes du 66</h1>
<img src="blason.jpg" alt="photo" style="display:block; margin:0 auto;">
<div style="display:flex; gap:20px; margin-bottom:20px;">
  <img src="sardana.JPG" alt="Image 2" style="height:120px; border-radius:8px;">
</div>
            
  
<h2>Prochains evenements</h2>
<div id="liste-sardanes" class="grid"></div>
<script>
console.log("VERSION 3 - Script corrige");
// Convertit DD-MM-YYYY -> objet Date()
function parseDate(d) {
  const [jour, mois, annee] = d.split("-");
  return new Date(`${annee}-${mois}-${jour}`);
}
// Affichage FR
function formatDateFR(dateObj) {
  return dateObj.toLocaleDateString("fr-FR", {
    day: "numeric",
    month: "long",
    year: "numeric"
  });
}
  // Jour de la semaine FR 
  function getJourSemaineFR(dateObj) { 
    const jours = ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"]; 
    return jours[dateObj.getDay()]; }
// URLs des cobles
const coblesURL = {
  "Tres Vents": "https://tresvents.com/presse_articles.html?utm_source=copilot.com",
  "Mil.lenaria": "https://www.coblamillenaria.cat",
  "Ciutat de Girona": "https://www.coblagirona.cat",
  "Sol de Banyuls": "https://coblasoldebanyuls.wixsite.com/coblasdb",
  "Nova Germanor": "https://coblanovagermanor.over-blog.com/",
  "Principal del Rossello": "http://www.principaldelrossello.com/",
  "Les Casenoves": "https://www.facebook.com/coblalescasenoves/",
};
// Chargement du JSON
fetch("./events.json?nocache=" + Date.now())
  .then(response => response.json())
  .then(data => {
    const liste = document.getElementById("liste-sardanes");
    // Tri correct
    data.sort((a, b) => parseDate(a.date) - parseDate(b.date));
    // Affichage
    data.forEach(event => {
      const item = document.createElement("div");
      item.className = "event-card";
      const dateObj = parseDate(event.date);
      item.innerHTML = `
         <div class="event-jour"> jour : ${getJourSemaineFR(dateObj)}</div>
        <div class="event-date"> date : ${formatDateFR(dateObj)} - ${event.heure}</div>
        <div class="event-lieu"> lieu : <strong>${event.lieu}</strong></div>
        <div class="event-salle"> salle : ${event.salle}</div>
        <div class="event-cobla"> Cobla :
          ${coblesURL[event.cobla]
            ? `<a href="${coblesURL[event.cobla]}" target="_blank">${event.cobla}</a>`
            : event.cobla}
        </div>
        <div class="event-type"> type : ${event.type}</div>
        <div class="event-tarif"> Tarif : ${event.tarif}</div>
      `;
      liste.appendChild(item);
    });
  })
  .catch(error => console.error("Erreur de chargement :", error));
</script>
<footer style="margin-top:40px; padding:15px; background:#f2d9e6; border-radius:8px; text-align:center;
font-family:sans-serif; color:#333;">
  Pour me contacter :
  <a href="mailto:cuscullets@sfr.fr" style="font-size:1.4em; font-weight:bold;
color:#333;">cuscullets@sfr.fr</a>
  <div style="margin-top:15px; font-size:0.95em;">
    Nombre de visites aujourd'hui : <span id="visits-today"></span><br>
    Visites totales : <span id="visits-total"></span>
  </div>
<script>
  const TOTAL_KEY = "visites_total";
  const DAILY_KEY = "visites_" + new Date().toISOString().slice(0,10);
  let total = localStorage.getItem(TOTAL_KEY);
  let daily = localStorage.getItem(DAILY_KEY);
  total = total ? parseInt(total) : 0;
  daily = daily ? parseInt(daily) : 0;
  total += 1;
  daily += 1;
  localStorage.setItem(TOTAL_KEY, total);
  localStorage.setItem(DAILY_KEY, daily);
  document.getElementById("visits-total").innerText = total;
  document.getElementById("visits-today").innerText = daily;
</script>
</footer>
</body>
</html>
